[TOC]

# JVM内存结构 VS Java内存模型 VS Java对象模型

**JVM内存结构**、**Java内存模型**和**Java对象模型**，这就是**三个截然不同的概念**，但是很多人容易弄混。

- JVM内存结构：和Java虚拟机的运行时区域有关。由Java虚拟机规范定义。描述的是Java程序执行过程中，由JVM管理的不同数据区域。各个区域有其特定的功能。
- Java内存模型：JMM是和多线程相关的，他描述了一组规则或规范，这个规范定义了一个线程对共享变量的写入时对另一个线程是可见的。JMM就是围绕着多线程通信以及与其相关的一系列特性而建立的模型。
- Java对象模型：和Java对象在虚拟机中的表现形式有关。

## JVM内存结构

参考这篇文章 [jvm内存结构.md](jvm内存结构.md) 

Java代码是要运行在虚拟机上的，而虚拟机在执行Java程序的过程中会把所管理的内存划分为若干个不同的数据区域，这些区域都有各自的用途。其中有些区域随着虚拟机进程的启动而存在，而有些区域则依赖用户线程的启动和结束而建立和销毁。

## Java内存模型

参考这篇文章 [Java内存模型.md](Java内存模型.md) 

Java堆和方法区的区域是多个线程共享的数据区域。也就是说，多个线程可能可以操作保存在堆或者方法区中的同一个数据。这也就是我们常说的“**Java的线程间通过共享内存进行通信**”。

Java内存模型是根据英文Java Memory Model（JMM）翻译过来的。其实JMM并不像JVM内存结构一样是真实存在的。他只是一个抽象的概念。**JMM是和多线程相关的**，他描述了一组规则或规范，这个规范定义了**一个线程对共享变量的写入时对另一个线程是可见的**。

那么，简单总结下，Java的多线程之间是通过共享内存进行通信的，而由于采用共享内存进行通信，在通信过程中会存在一系列如可见性、原子性、顺序性等问题，而**JMM就是围绕着多线程通信以及与其相关的一系列特性而建立的模型**。JMM定义了一些语法集，这些语法集映射到Java语言中就是volatile、synchronized等关键字。

![11](https://ws3.sinaimg.cn/large/006tNc79ly1fz1qaaqdxlj30br0ah0st.jpg)

在Java中，JMM是一个非常重要的概念，正是由于有了JMM，Java的并发编程才能避免很多问题。

## Java对象模型

Java是一种面向对象的语言，而Java对象在JVM中的存储也是有一定的结构的。而这个**关于Java对象自身的存储模型称之为Java对象模型**。

HotSpot虚拟机中，设计了一个OOP-Klass Model。OOP（Ordinary Object Pointer）指的是普通对象指针，而Klass用来描述对象实例的具体类型。

每一个Java类，在被JVM加载的时候，JVM会给这个类创建一个`instanceKlass`，保存在方法区，用来在JVM层表示该Java类。当我们在Java代码中，使用new创建一个对象的时候，JVM会创建一个`instanceOopDesc`对象，这个对象中包含了对象头以及实例数据。

![20170615230126453](https://ws3.sinaimg.cn/large/006tNc79ly1fz1qgj0jr2j31840js429.jpg)

这就是一个简单的Java对象的OOP-Klass模型，即Java对象模型。



















